scale_fill_brewer(palette = "RdYlGn") +
theme_void()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>%
ggplot(aes(x = Year, y = `Strategy Count`, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
#geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) +
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
theme_void()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup() %>%
ggplot(aes(x = Year, y = `Strategy Count`, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
#geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) +
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
theme_void()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup() %>%
ggplot(aes(x = Year, y = `Strategy Count`, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
#geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) +
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
df <- diamonds %>%
group_by(cut, clarity) %>%
summarise(count = n()) %>%
mutate(cut.count = sum(count),
prop = count/sum(count)) %>%
ungroup()
df
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`),prop = `Strategy Count`/sum(`Strategy Count`)) %>% ungroup()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(prop = `Strategy Count`/sum(`Strategy Count`)) %>% ungroup()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(prop = `Strategy Count`/sum(`Strategy Count`)) %>% ungroup()
youtube %>% filter(Year > 2012) %>%
group_by(Year, Strategy) %>% summarize(`Strategy Count` = sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(prop = `Strategy Count`/sum(`Strategy Count`)) %>% ungroup() %>%
ggplot(aes(x = Year, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
#geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) +
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
ggplot(df,
aes(x = cut, y = prop, width = cut.count, fill = clarity)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~cut, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
# theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(count =n()) %>% mutate(strat_count = sum(count), prop = count / sum(count)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(count =n()) %>% mutate(strat_count = sum(count), prop = count / sum(count)) %>% ungroup() %>% ggplot(aes(x = count, y = prop, width = strat_count, fill = Strategy)) +
+     geom_bar(stat = "identity", position = "fill", colour = "black") +
+     # geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
+     facet_grid(~Year, scales = "free_x", space = "free_x") +
+     scale_fill_brewer(palette = "RdYlGn") +
+     # theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
+     theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(count =n()) %>% mutate(strat_count = sum(count), prop = count / sum(count)) %>% ungroup() %>% ggplot(aes(x = count, y = prop, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
# theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = count, y = prop, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
# theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`)) %>% ungroup()
.198+.198+.573
.198+.198+.573+.0312
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") +
# theme(panel.spacing.x = unit(0, "npc")) + # if no spacing preferred between bars
theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), `View Count` =sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), `View Count` =sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup() %>%
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% filter(year > 2012) %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% filter(Year > 2012) %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Brand, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Brand, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") + coord_flip()
youtube %>% group_by(Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Brand, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Year~Brand, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Brand~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Brand~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") + theme_void()
youtube %>% filter(Brand != "Doritos") %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Brand~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") + theme_void()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% filter(Brand != "Doritos") %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = Views, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Brand~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn") + theme_void()
youtube %>% filter(Brand != "Doritos") %>% group_by(Year, Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = Views, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(Brand~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = prop, width = Views, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup() %>% ggplot(aes(x = strat_count, y = Views, width = strat_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(strat_count = sum(`Strategy Count`), prop = `Strategy Count` / sum(`Strategy Count`), Views = sum(`View Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), Views = sum(`View Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count' = strat_count = sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = `Ad Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Brand, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = `Ad Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Brand, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
sub_long2 %>% ggplot(aes(year, Strategy, fill=Count)) +
geom_tile(color="white") + scale_x_discrete() + coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal") + scale_fill_gradient(labels = c("Never", "Always"))
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=Count)) +
geom_tile(color="white") + scale_x_discrete()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=prop)) +
geom_tile(color="white") + scale_x_discrete()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=`View Count`)) +
geom_tile(color="white") + scale_x_discrete()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=`View Count`)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal") + scale_fill_gradient(labels = c("Never", "Always"))
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=`View Count`)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=prop)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup(
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=prop)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()%>% ggplot(aes(Year, Strategy, fill=prop)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+
scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtube
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
#youtube <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-03-02/youtube.csv')
youtube <- readr::read_csv('youtube.csv')
youtube <- readr::read_csv('youtube.csv')
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube %>% select(year,brand,strategy, view_count)
youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youtube <- youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youyoutube
youtube
youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count))
youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views))
youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views) )
youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views) ) %>% ggplot(aes(strategy, Views)) + geom_bar(stat = "identity")
youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views) ) %>% ggplot(aes(strategy, Views)) + geom_bar(stat = "identity") + coord_flip()
youtube <- youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtube
youtube$strategy <- factor(youtube$strategy, levels = youtube$strategy[order(youtube$Views)])
youtube$strategy <- factor(youtube$strategy, levels = youtube$strategy[order(youtube$Views)])
youtube$strategy[order(youtube$Views)]
factor(youtube$strategy, levels = youtube$strategy[order(youtube$Views)])
youtube <- readr::read_csv('youtube.csv')
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube <- youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youtube <- youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtube
youtube$strategy <- factor(youtube$strategy, levels = youtube$strategy[order(youtube$Views)])
youtube %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity")
youtube %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip()
view(youtube)
youtube %>% filter(Views > 750000) %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip()
youtube <- readr::read_csv('youtube.csv')
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube <- youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youtube <- youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtube$strategy <- factor(youtube$strategy, levels = youtube$strategy[order(youtube$Views)])
youtube %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip()
youtube %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(year)
youtube
youtube %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(.~year)
youtube %>% filter(Views > 750000) %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(.~year)
youtube %>% filter(Views > 750000) %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(year~.)
youtube %>% filter(Views > 750000) %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(.~year)
youtube %>% filter(Views > 750000) %>% ggplot(aes(strategy, Views)) +                                    # Decreasingly ordered barchart
geom_bar(stat = "identity") + coord_flip() + facet_grid(.~year, scales = "free_x")
youtube <- readr::read_csv('youtube.csv')
# In the view_count data replace NAs with a zero
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube <- youtube %>% mutate(funny = if_else(funny==TRUE,1,0)) %>%
mutate(show_product_quickly = if_else(show_product_quickly==TRUE,1,0)) %>%
mutate(patriotic = if_else(patriotic==TRUE,1,0)) %>%
mutate(celebrity = if_else(celebrity==TRUE,1,0)) %>%
mutate(danger = if_else(danger==TRUE,1,0)) %>%
mutate(animals = if_else(animals==TRUE,1,0)) %>%
mutate(use_sex = if_else(use_sex==TRUE,1,0))
# Count the strategies used in each add...
youtube$Strategy_Count <- youtube$funny + youtube$patriotic + youtube$celebrity + youtube$danger + youtube$animals + youtube$use_sex
# Add a strategy category of none and select only the cols of interest and ignore ads with no strategy
youtube <- youtube %>% mutate(No_Strategy = ifelse(Strategy_Count==0,1,0)) %>%
filter(Strategy_Count>0) %>%
select(year,brand,funny,patriotic,celebrity,danger,animals, use_sex, Strategy_Count, view_count)
# Clean Up column names
names(youtube) <- gsub("_", " ", names(youtube)) %>% str_to_title()
# Pivot the table long such that each strategy for an ad comprises a row. For example, an ad that used three
# strategies will have three rows.
youtube <- youtube %>% pivot_longer(Funny:'Use Sex', names_to="Strategy", values_to = "Count")
# Then allocate the strategy count evenly across the strategies. For example, an ad using three strategies = each strategy will have been used .333 times in that ad.
youtube$`Strategy Count` <- youtube$Count / youtube$`Strategy Count`
# Allocate the view account evenly across the strategies too,
youtube$`View Count` <- youtube$`View Count` * youtube$`Strategy Count`
# Filter out rows of unused strategies..
youtube <- youtube %>% filter(Count > 0) %>% select(-Count)
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = `Ad Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup()
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = `View Count`, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = sum(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = view_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = mean(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = view_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtube %>% group_by(Year, Strategy) %>% summarize(`Strategy Count` =sum(`Strategy Count`), `View Count` = sum(`View Count`)) %>% mutate(view_count = median(`View Count`), prop = `View Count` / sum(`View Count`), 'Ad Count'= sum(`Strategy Count`)) %>% ungroup() %>% ggplot(aes(x = `Ad Count`, y = prop, width = view_count, fill = Strategy)) +
geom_bar(stat = "identity", position = "fill", colour = "black") +
# geom_text(aes(label = scales::percent(prop)), position = position_stack(vjust = 0.5)) + # if labels are desired
facet_grid(~Year, scales = "free_x", space = "free_x") +
scale_fill_brewer(palette = "RdYlGn")
youtubeUnSort
youtubeUnSort <- youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtube <- readr::read_csv('youtube.csv')
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube <- youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youtubeHeat <- youtube %>% group_by(year, strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtubeHeat
youtubeHeat%>% ggplot(aes(Year, Strategy, fill=Views)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat%>% ggplot(aes(Year, strategy, fill=Views)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat%>% ggplot(aes(year, strategy, fill=Views)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat%>% ggplot(aes(year, strategy, fill=median(Views))) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat%>% ggplot(aes(year, strategy, fill=mean(Views))) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat%>% ggplot(aes(year, strategy, fill=Views)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
youtubeHeat
youtubeSort <- youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count)) %>% mutate(view_count = sum(Views), percentViews = Views /sum(Views))
youtubeSort
youtubeHeat%>% ggplot(aes(year, strategy, fill=Views)) +
geom_tile(color="white") + scale_x_discrete()+ coord_equal() + theme(axis.ticks.y = element_blank(),panel.background = element_blank(),legend.position = c(0.87, 1.21),legend.background = element_blank(),legend.direction = "horizontal")+scale_fill_continuous(high = "#132B43", low = "#56B1F7")
write.csv(youtubeSort, "temp.csv", row.names = FALSE)
youtube <- readr::read_csv('youtube.csv')
# In the view_count data replace NAs with a zero
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube <- youtube %>% select(year,brand,strategy, view_count) %>% arrange(desc(view_count))
youtube
write.csv(youtube, "temp.csv", row.names = FALSE)
set.seed(20190708)
genes <- paste("gene",1:1000,sep="")
genes
x <- list(
A = sample(genes,300),
B = sample(genes,525),
C = sample(genes,440),
D = sample(genes,350)
)
x
str(x)
youtube <- readr::read_csv('youtube.csv')
youtube <- readr::read_csv('youtube.csv')
youtube$view_count <- youtube$view_count %>% replace_na(0)
youtube$strategy <- paste(
if_else(youtube$funny==TRUE, "Funny", ""),
if_else(youtube$patriotic==TRUE, "Patriotic", ""),
if_else(youtube$celebrity==TRUE, "Celebrity", ""),
if_else(youtube$danger==TRUE, "Danger", ""),
if_else(youtube$animals==TRUE, "Animals", ""),
if_else(youtube$use_sex==TRUE, "Sex", ""), sep=" ")
youtube$strategy <- youtube$strategy %>% str_squish()
youtube$strategy <- if_else(youtube$strategy=="", "None", youtube$strategy)
youtube
youtube <- youtube %>% select(year,brand,strategy, view_count, like_count, dislike_count) %>% arrange(desc(view_count))
youtube
youtube$dislike_count <- youtube$dislike_count * -1
youtube
youtube$dislike_count <- youtube$dislike_count * -1
youtube
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count))
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na()
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1)
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1)
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count")
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(subset = .(stat == "Likes"), stat = "identity") + geom_bar(subset = .(stat == "Dislike"), stat = "identity")
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(subset = (stat == "Likes"), stat = "identity") + geom_bar(subset = (stat == "Dislike"), stat = "identity")
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(subset(stat == "Likes"), stat = "identity") + geom_bar(subset(stat == "Dislike"), stat = "identity")
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat))
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) geom_bar(subset(stat=="Likes"))
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(subset(stat=="Likes"))
youtube %>% subset(stat=="Likes")
?subset
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat=="Likes")
tmp <- youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count")
tmp
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat=="Likes")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat))
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat="Likes")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat=="Likes")
str(tmp)
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(subset(tmp, stat=="Likes"))
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"))
subset(tmp, stat=="Likes")
subset(tmp, stat=="Likes")$Count
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes")$Count)
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"))
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity")+ geom_bar(data = subset(tmp, stat=="Dislikes"), stat="identity")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity") + geom_bar(data = subset(tmp, stat=="Dislike"), stat="identity")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity") + geom_bar(data = subset(tmp, stat=="Dislike"), stat="identity") + coord_flip()
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat="identity")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity") + geom_bar(data = subset(tmp, stat=="Dislike"), stat="identity") + coord_flip()
youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count") %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(stat=="Likes")
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity") + geom_bar(data = subset(tmp, stat=="Dislike"), stat="identity") + coord_flip()
tmp$strategy <- factor(tmp$strategy, levels = tmp$strategy[order(tmp$Views)])
tmp$strategy <- factor(tmp$strategy, levels = tmp$strategy[order(tmp$Views)])
str(tmp)
head(tmp)
tmp$strategy <- factor(tmp$strategy, levels = tmp$strategy[order(tmp$Count)])
tmp <- youtube %>% group_by(strategy) %>% summarize(Views = sum(view_count), Likes = sum(like_count), Dislike = sum(dislike_count)) %>% drop_na() %>% mutate(Dislike = Dislike*-1) %>% pivot_longer(Views:Dislike, names_to = "stat", values_to = "Count")
tmp
youtube
tmp
tmp$strategy <- factor(tmp[tmp$stat=="Views"]$strategy, levels = tmp$strategy[order(tmp$Count)])
tmp[tmp$stat=="Views"]$strategy
tmp[tmp$stat=="Views",]$strategy
tmp$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp$strategy[order(tmp$Count)])
tmp
tmp[tmp$stat=="Views",]
tmp[tmp$stat=="Views",]$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp$strategy[order(tmp$Views)])
tmp[tmp$stat=="Views",]$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp$strategy[order(tmp$Count)])
tmp[tmp$stat=="Views",]$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp[tmp$stat=="Views",][order(tmp$Count)])
tmp[tmp$stat=="Views",]$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp$strategy[order(tmp[tmp$stat=="Views",]$Count)])
tmp$strategy <- factor(tmp$strategy, levels = tmp$strategy[order(tmp$Count)])
tmp$strategy <- factor(tmp$strategy, levels = tmp[tmp$stat=="Views"]$strategy[order(tmp$Count)])
tmp$strategy <- factor(tmp[tmp$stat=="Views"]$strategy, levels = tmp[tmp$stat=="Views"]$strategy[order(tmp$Count)])
tmp[tmp$stat=="Views",]$strategy <- factor(tmp[tmp$stat=="Views",]$strategy, levels = tmp[tmp$stat=="Views",][order(tmp[tmp$stat=="Views",]$Count)])
tmp$strategy <- factor(tmp$strategy, levels = tmp$strategy[order(tmp[tmp$stat=="Views",]$Count)])
tmp$strategy <- factor(tmp$strategy, levels = tmp[tmp$stat=="Views",]$strategy[order(tmp[tmp$stat=="Views",]$Count)])
tmp %>% ggplot(aes(x=strategy, y=Count, fill=stat)) + geom_bar(data = subset(tmp, stat=="Likes"), stat="identity") + geom_bar(data = subset(tmp, stat=="Dislike"), stat="identity") + coord_flip()
