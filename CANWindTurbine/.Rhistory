color = ~cinderella,
marker = list(symbol = "square-open", size=18, line = list(color = 'rgba(10, 10, 10, .5)',width = 1)),
text=paste("Seed: ", scatterData$seed, "\n", "Round: ", scatterData$finRound, "\n", "prob: ", scatterData$prob,"%", sep=""),hoverinfo = 'text',showlegend = FALSE)
fig <- fig %>% layout(annotations = a) %>% layout(annotations = b)%>% layout(annotations = c)%>% layout(annotations = d)%>% layout(title = 'NCAAW Tournament Probabilities',xaxis = list(title = paste("Final Round", "\n","( 1=1st Round, 7 = Championship)", sep="")),yaxis = list(title = "Seed"))
fig
d <- list(
x = scatterData$finRound,
y = scatterData$seed,
text = scatterData$prob,
xref = "x",
yref = "y",
textfont = list(color = '#000000', size = 6),
showarrow = F,
arrowhead = 4,
ax = 0,
ay = 0
)
fig <- scatterData %>% plot_ly(x = ~finRound, y = ~seed,
colors = c("blue", "coral2"),
color = ~cinderella,
marker = list(symbol = "square-open", size=18, line = list(color = 'rgba(10, 10, 10, .5)',width = 1)),
text=paste("Seed: ", scatterData$seed, "\n", "Round: ", scatterData$finRound, "\n", "prob: ", scatterData$prob,"%", sep=""),hoverinfo = 'text',showlegend = FALSE)
fig <- fig %>% layout(annotations = a) %>% layout(annotations = b)%>% layout(annotations = c)%>% layout(annotations = d)%>% layout(title = 'NCAAW Tournament Probabilities',xaxis = list(title = paste("Final Round", "\n","( 1=1st Round, 7 = Championship)", sep="")),yaxis = list(title = "Seed"))
fig
d <- list(
x = scatterData$finRound,
y = scatterData$seed,
text = scatterData$prob,
xref = "x",
yref = "y",
textfont = list(color = '#000000', size = 3),
showarrow = F,
arrowhead = 4,
ax = 0,
ay = 0
)
fig <- fig %>% layout(annotations = a) %>% layout(annotations = b)%>% layout(annotations = c)%>% layout(annotations = d)%>% layout(title = 'NCAAW Tournament Probabilities',xaxis = list(title = paste("Final Round", "\n","( 1=1st Round, 7 = Championship)", sep="")),yaxis = list(title = "Seed"))
fig
![Caption for the picture.](`NCAAWp.png`)
![Caption for the picture.](`/NCAAWp.png`)
knit_with_parameters('C:/Users/mikew/OneDrive/dev/TidyTuesday/TidyTuesday/NCAAW/NCAAW.Rmd')
install.packages("pandoc")
library(pandoc)
Sys.setenv("plotly_username"="mikeShout")
Sys.setenv("plotly_api_key"="oDYXwN6Nlxfd7PWZKHhC")
fig
# Get Data
tourny <- read_csv("tourny.csv")
#Convert Finishing round indicator to a number
tourny$finRound <- case_when(
tourny$tourney_finish == "Champ" ~ 7,
tourny$tourney_finish == "N2nd" ~ 6,
tourny$tourney_finish == "NSF" ~ 5,
tourny$tourney_finish == "RF" ~ 4,
tourny$tourney_finish == "RSF" ~ 3,
tourny$tourney_finish == "2nd" ~ 2,
tourny$tourney_finish == "1st" ~ 1,)
# Remove rows where there is no finih round data
tourny <- tourny %>% drop_na(finRound) %>% drop_na(seed)
# Create a reference table for counts of teams that finish in each round. This will be used for calculating probabilities...
RoundCounts <- tourny %>% group_by(finRound) %>% summarize(RoundFreq=n())
#Calculate probabilities of each seed making it to their respective final rounds
scatterData <- tourny %>% group_by(seed, finRound) %>% summarize(freq = n()) %>% arrange(finRound) %>% left_join(RoundCounts) %>% mutate(prob = (round((freq / RoundFreq)*100,1)))
#Format the probability for the chart
scatterData[scatterData$prob >=1,]$prob <- round(scatterData[scatterData$prob >=1,]$prob,0)
# Highlight teams that have overcome low odds aka cinderellas
scatterData$cinderella <- case_when(scatterData$prob < 4 & scatterData$finRound > 2 ~ "Cinderella", TRUE ~ "")
#highlight certain teams
a <- list(
x = tourny[tourny$seed == 11 & tourny$finRound == 4,]$finRound,
y = tourny[tourny$seed == 11 & tourny$finRound == 4,]$seed,
text = paste(tourny[tourny$seed == 11 & tourny$finRound == 4,]$school,", ",tourny[tourny$seed == 11 & tourny$finRound == 4,]$year,sep="" ),
xref = "x",
yref = "y",
showarrow = TRUE,
arrowhead = 4,
ax = 20,
ay = -40
)
b <- list(
x = tourny[tourny$seed == 9 & tourny$finRound == 5,]$finRound,
y = tourny[tourny$seed == 9 & tourny$finRound == 5,]$seed,
text = paste(tourny[tourny$seed == 9 & tourny$finRound == 5,]$school,", ",tourny[tourny$seed == 9 & tourny$finRound == 5,]$year,sep="" ),
xref = "x",
yref = "y",
showarrow = TRUE,
arrowhead = 4,
ax = 20,
ay = -40
)
c <- list(
x = tourny[tourny$seed == 5 & tourny$finRound == 6,]$finRound,
y = tourny[tourny$seed == 5 & tourny$finRound == 6,]$seed,
text = paste(tourny[tourny$seed == 5 & tourny$finRound == 6,]$school,", ",tourny[tourny$seed == 5 & tourny$finRound == 6,]$year,sep="" ),
xref = "x",
yref = "y",
showarrow = TRUE,
arrowhead = 4,
ax = 20,
ay = -40
)
d <- list(
x = scatterData$finRound,
y = scatterData$seed,
text = scatterData$prob,
xref = "x",
yref = "y",
textfont = list(color = '#000000', size = 3),
showarrow = F,
arrowhead = 4,
ax = 0,
ay = 0
)
fig <- scatterData %>% plot_ly(x = ~finRound, y = ~seed,
colors = c("blue", "coral2"),
color = ~cinderella,
marker = list(symbol = "square-open", size=18, line = list(color = 'rgba(10, 10, 10, .5)',width = 1)),
text=paste("Seed: ", scatterData$seed, "\n", "Round: ", scatterData$finRound, "\n", "prob: ", scatterData$prob,"%", sep=""),hoverinfo = 'text',showlegend = FALSE)
fig <- fig %>% layout(annotations = a) %>% layout(annotations = b)%>% layout(annotations = c)%>% layout(annotations = d)%>% layout(title = 'NCAAW Tournament Probabilities',xaxis = list(title = paste("Final Round", "\n","( 1=1st Round, 7 = Championship)", sep="")),yaxis = list(title = "Seed"))
fig
api_create(fig, filename = "NCAAW Basketball Tournament Analysis")
install.packages("tidyverse")
library(tidyverse)
library(tidyverse)
library(knitr)
library(kableExtra)
library(streamgraph)
library(ggstream)
beer_me <- readr::read_csv("GABF.csv")
beer_me <- beer_me %>% mutate(SimpleCat = case_when(
str_detect(category, "Stout") ~ "Stout",
str_detect(category, "Bock") ~ "Bock",
str_detect(category, "Porter") ~ "Porter",
str_detect(category, "Pale Ale") ~ "Pale Ale",
str_detect(category, "Belgian|Belgo") ~ "Belgian Beer",
str_detect(category, "Brown Ale") ~ "Brown Ale",
str_detect(category, "Red Ale") ~ "Red Ale",
str_detect(category, "Wheat|Witbier") ~ "Wheat Beer",
str_detect(category, "Sour") ~ "Sour",
str_detect(category, "Pilsener") ~ "Pilsener",
str_detect(category, "Lager") ~ "Lager",
str_detect(category, "India Pale Ale") ~ "India Pale Ale",
str_detect(category, "Barley Wine") ~ "Barley Wine",
str_detect(category, "Rye Beer") ~ "Rye Beer",
str_detect(category, "Specialty Beer") ~ "Specialty Beer",
str_detect(category, "Scottish") ~ "Scottish-Style Ale",
str_detect(category, "Experimental") ~ "Experimental Beer",
str_detect(category, "Summer Ale") ~ "Summer Ale",
str_detect(category, "Aged") ~ "Aged",
str_detect(category, "Session") ~ "Session",
str_detect(category, "Fruit|Spice|Raspberry") ~ "Fruit Beer",
str_detect(category, "Blonde|Gold") ~ "Golden or Blonde Ale",
str_detect(category, "Bitter") ~ "Bitter",
str_detect(category, "German|Bier|Munich|Munchner|Oktoberfest|Hefeweizen|Hefeweissbier") ~ "German Style",
TRUE ~ "Other"))
filtered_beer <- beer_me %>% filter(SimpleCat != "Other", year > 1998 & year < 2020) %>% group_by(year, SimpleCat) %>% summarize(n = n())  %>% arrange(desc(n))
filtered_beer <- filtered_beer %>% mutate(topCat = case_when(
SimpleCat== "Belgian Beer" ~ "Y",
SimpleCat== "Pale Ale" ~ "Y",
SimpleCat== "Sour" ~ "Y",
SimpleCat== "Lager" ~ "Y",
SimpleCat== "German Style" ~ "Y",
SimpleCat== "Stout" ~ "Y",
SimpleCat== "Wheat Beer" ~ "Y",
TRUE ~ "N"))
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "TEST", x=150, y=2018, color="black", size=10)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate("label", 50, 2015, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", 50, 2015, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=2015, y=50, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=2000, y=50, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=1, y=!, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=1, y=1, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=x=as.Date("2000-01-01"), y=1, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "asdkjhadsfkjhadsfasdf", x=as.Date("2000-01-01"), y=1, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Test", x=as.Date("2000-01-01"), y=1, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Test", x=as.Date("2020-01-01"), y=1, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Test", x=as.Date("2020-01-01"), y=13, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian Beer", x=as.Date("2020-01-01"), y=13, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian Beer", x=as.Date("2015-01-01"), y=13, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian Beer", x=as.Date("2019-01-01"), y=13, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian Beer", x=as.Date("2017-01-01"), y=13, color = "black", size = 12)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13) %>%
sg_title(title = "Changing Tastes In Beer")
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13) %>% sg_title(title = "Changing Tastes In Beer")
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_title(title = "Changing Tastes In Beer") %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
?sg_axis_x
library(cowplot)
install.packages("cowplot")
library(cowplot)
library(cowplot)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_title(title = "Changing Tastes In Beer") %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13) %>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end")
?sg_add_marker
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13) %>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end")
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE)%>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end") %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE) %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13) %>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end")
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE)%>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end") %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
streamgraph(filtered_beer[filtered_beer$topCat=="Y",], date = "year", value = "n", key = "SimpleCat", order = "inside-out", interactive = TRUE)%>% sg_add_marker(x=as.Date("2005-01-01"), "1981 (10.8%)", anchor="end") %>% sg_axis_x(5, "year", "%Y") %>% sg_annotate(label = "Belgian", x=as.Date("2018-01-01"), y=13, color = "black", size = 13) %>% sg_annotate(label = "Stout", x=as.Date("2018-01-01"), y=36, color = "black", size = 13) %>% sg_annotate(label = "Lager", x=as.Date("2018-01-01"), y=52, color = "black", size = 13)%>% sg_annotate(label = "German", x=as.Date("2018-01-01"), y=68, color = "black", size = 13)%>% sg_annotate(label = "Wheat", x=as.Date("2018-01-01"), y=81, color = "black", size = 13)%>% sg_annotate(label = "Pale Ale", x=as.Date("2018-01-01"), y=100, color = "black", size = 13)%>% sg_annotate(label = "Sour", x=as.Date("2018-01-01"), y=120, color = "black", size = 13)
?cowplot
beer_me <- readr::read_csv("GABF.csv")
beer_me <- beer_me %>% mutate(SimpleCat = case_when(
str_detect(category, "Stout") ~ "Stout",
str_detect(category, "Bock") ~ "Bock",
str_detect(category, "Porter") ~ "Porter",
str_detect(category, "Pale Ale") ~ "Pale Ale",
str_detect(category, "Belgian|Belgo") ~ "Belgian Beer",
str_detect(category, "Brown Ale") ~ "Brown Ale",
str_detect(category, "Red Ale") ~ "Red Ale",
str_detect(category, "Wheat|Witbier") ~ "Wheat Beer",
str_detect(category, "Sour") ~ "Sour",
str_detect(category, "Pilsener") ~ "Pilsener",
str_detect(category, "Lager") ~ "Lager",
str_detect(category, "India Pale Ale") ~ "India Pale Ale",
str_detect(category, "Barley Wine") ~ "Barley Wine",
str_detect(category, "Rye Beer") ~ "Rye Beer",
str_detect(category, "Specialty Beer") ~ "Specialty Beer",
str_detect(category, "Scottish") ~ "Scottish-Style Ale",
str_detect(category, "Experimental") ~ "Experimental Beer",
str_detect(category, "Summer Ale") ~ "Summer Ale",
str_detect(category, "Aged") ~ "Aged",
str_detect(category, "Session") ~ "Session",
str_detect(category, "Fruit|Spice|Raspberry") ~ "Fruit Beer",
str_detect(category, "Blonde|Gold") ~ "Golden or Blonde Ale",
str_detect(category, "Bitter") ~ "Bitter",
str_detect(category, "German|Bier|Munich|Munchner|Oktoberfest|Hefeweizen|Hefeweissbier") ~ "German Style",
TRUE ~ "Other"))
filtered_beer <- beer_me %>% filter(SimpleCat != "Other", year > 1998 & year < 2020) %>% group_by(year, SimpleCat) %>% summarize(n = n())  %>% arrange(desc(n))
write.csv(filtered_beer, "temp2.csv")
write.csv(beer_me, "temp2.csv")
write.csv(beer_me, "temp3.csv")
filtered_beer <- filtered_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
TRUE ~ 0))
filtered_beer
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move!=0,]
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move!=0,] %>% arrange(desc(move))
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move))
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot( aes(x = ~SimpleCat, y = move)) + geom_col(width = 0.7)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot( aes(x = ~SimpleCat, y = ~move)) + geom_col(width = 0.7)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot( aes(x = ~SimpleCat, y = ~move)) + geom_col()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(~SimpleCat,~move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,]
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% ggplot(aes(SimpleCat,move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(SimpleCat,move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(move) %>% ggplot(aes(SimpleCat,move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(move) %>% ggplot(aes(x=reorder(SimpleCat, SimpleCat, function(x)-length(x)),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(move) %>% ggplot(aes(x=reorder(SimpleCat, SimpleCat, function(x) length(x)),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(move) %>% ggplot(aes(x=reorder(SimpleCat, SimpleCat, function(x) length(move)),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(SimpleCat,move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(x=SimpleCat,y=move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(x=SimpleCat,y=x=reorder(move, move, function(x)-length(move))))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(x=SimpleCat,y=reorder(move, move, function(x)-length(move))))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(x=SimpleCat,y=reorder(move, move, function(x)-sum(move))))+geom_bar(stat="identity")+coord_flip()
filtered_beer
filtered_beer$OrderCat <- factor(filtered_beer$SimpleCat, levels=filtered_beer$SimpleCat[order(filtered_beer$move)])
filtered_beer$OrderCat <- factor(filtered_beer$SimpleCat, levels=filtered_beer$SimpleCat[order(filtered_beer$move),])
factor(filtered_beer$SimpleCat,levels = filtered_beer$SimpleCat[order(filtered_beer$move)])
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(move) %>% ggplot(aes(x=reorder(SimpleCat, SimpleCat, function(x) length(move)),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(SimpleCat,move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(stat="identity")+coord_flip()
filtered_beer
beer_me
moving_beer <- beer_me %>% filter(SimpleCat != "Other", year > 1998 & year < 2020) %>% group_by(year, SimpleCat, category) %>% summarize(n = n())  %>% arrange(desc(n))
moving_beer
moving_beer <- filtered_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
category== "Smoke-Flavored Beer" ~ -5,
category== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0))
moving_beer <- moving_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
category== "Smoke-Flavored Beer" ~ -5,
category== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0))
moving_beer[moving_beer$move !=0,]
moving_beer <- moving_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
category== "Smoke-Flavored Beer" ~ -5,
category== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0)) %>% filter(move != 0)
moving_beer
moving_beer <- moving_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
category== "Smoke-Flavored Beer" ~ -5,
category== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0)) %>% mutate(moveCat = case_when(
move != 0 ~ "Y", TRUE ~ "N")
moving_beer <- moving_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
category== "Smoke-Flavored Beer" ~ -5,
category== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0)) %>% mutate(moveCat = case_when(
move != 0 ~ "Y", TRUE ~ "N"))
moving_beer
beer_me <- readr::read_csv("GABF.csv")
beer_me <- beer_me %>% mutate(SimpleCat = case_when(
str_detect(category, "Stout") ~ "Stout",
str_detect(category, "Bock") ~ "Bock",
str_detect(category, "Porter") ~ "Porter",
str_detect(category, "Pale Ale") ~ "Pale Ale",
str_detect(category, "Belgian|Belgo") ~ "Belgian Beer",
str_detect(category, "Brown Ale") ~ "Brown Ale",
str_detect(category, "Red Ale") ~ "Red Ale",
str_detect(category, "Wheat|Witbier") ~ "Wheat Beer",
str_detect(category, "Sour") ~ "Sour",
str_detect(category, "Pilsener") ~ "Pilsener",
str_detect(category, "Lager") ~ "Lager",
str_detect(category, "India Pale Ale") ~ "India Pale Ale",
str_detect(category, "Barley Wine") ~ "Barley Wine",
str_detect(category, "Rye Beer") ~ "Rye Beer",
str_detect(category, "Specialty Beer") ~ "Specialty Beer",
str_detect(category, "Scottish") ~ "Scottish-Style Ale",
str_detect(category, "Experimental") ~ "Experimental Beer",
str_detect(category, "Summer Ale") ~ "Summer Ale",
str_detect(category, "Aged") ~ "Aged",
str_detect(category, "Session") ~ "Session",
str_detect(category, "Fruit|Spice|Raspberry") ~ "Fruit Beer",
str_detect(category, "Blonde|Gold") ~ "Golden or Blonde Ale",
str_detect(category, "Bitter") ~ "Bitter",
str_detect(category, "German|Bier|Munich|Munchner|Oktoberfest|Hefeweizen|Hefeweissbier") ~ "German Style",
str_detect(category, "Smoke") ~ "Smoke Flavored",
str_detect(category, "Coffee") ~ "Coffee Flavored",
TRUE ~ "Other"))
filtered_beer <- beer_me %>% filter(SimpleCat != "Other", year > 1998 & year < 2020) %>% group_by(year, SimpleCat) %>% summarize(n = n())  %>% arrange(desc(n))
filtered_beer <- filtered_beer %>% mutate(topCat = case_when(
SimpleCat== "Belgian Beer" ~ "Y",
SimpleCat== "Pale Ale" ~ "Y",
SimpleCat== "Sour" ~ "Y",
SimpleCat== "Lager" ~ "Y",
SimpleCat== "German Style" ~ "Y",
SimpleCat== "Stout" ~ "Y",
SimpleCat== "Wheat Beer" ~ "Y",
TRUE ~ "N"))
filtered_beer <- filtered_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
SimpleCat== "Smoke-Flavored Beer" ~ -5,
SimpleCat== "Coffee Flavored Beer" ~ -2,
TRUE ~ 0))
filtered_beer
table(filtered_beer$move)
filtered_beer <- filtered_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
SimpleCat== "Smoke" ~ -5,
SimpleCat== "Coffee" ~ -2,
TRUE ~ 0))
table(filtered_beer$move)
beer_me <- beer_me %>% mutate(SimpleCat = case_when(
str_detect(category, "Stout") ~ "Stout",
str_detect(category, "Bock") ~ "Bock",
str_detect(category, "Porter") ~ "Porter",
str_detect(category, "Pale Ale") ~ "Pale Ale",
str_detect(category, "Belgian|Belgo") ~ "Belgian Beer",
str_detect(category, "Brown Ale") ~ "Brown Ale",
str_detect(category, "Red Ale") ~ "Red Ale",
str_detect(category, "Wheat|Witbier") ~ "Wheat Beer",
str_detect(category, "Sour") ~ "Sour",
str_detect(category, "Pilsener") ~ "Pilsener",
str_detect(category, "Lager") ~ "Lager",
str_detect(category, "India Pale Ale") ~ "India Pale Ale",
str_detect(category, "Barley Wine") ~ "Barley Wine",
str_detect(category, "Rye Beer") ~ "Rye Beer",
str_detect(category, "Specialty Beer") ~ "Specialty Beer",
str_detect(category, "Scottish") ~ "Scottish-Style Ale",
str_detect(category, "Experimental") ~ "Experimental Beer",
str_detect(category, "Summer Ale") ~ "Summer Ale",
str_detect(category, "Aged") ~ "Aged",
str_detect(category, "Session") ~ "Session",
str_detect(category, "Fruit|Spice|Raspberry") ~ "Fruit Beer",
str_detect(category, "Blonde|Gold") ~ "Golden or Blonde Ale",
str_detect(category, "Bitter") ~ "Bitter",
str_detect(category, "German|Bier|Munich|Munchner|Oktoberfest|Hefeweizen|Hefeweissbier") ~ "German Style",
str_detect(category, "Smoke") ~ "Smoke Flavored",
str_detect(category, "Coffee") ~ "Coffee Flavored",
TRUE ~ "Other"))
table(beer_me$SimpleCat)
table(beer_me[beer_me$year > 1998 & beer_me$year < 2020]$SimpleCat)
table(beer_me[beer_me$year > 1998 & beer_me$year < 2020,]$SimpleCat)
filtered_beer <- filtered_beer %>% mutate(move = case_when(
SimpleCat== "Lager" ~ -11,
SimpleCat== "Bock" ~ -1,
SimpleCat== "Pale Ale" ~ 23,
SimpleCat== "Belgian Beer" ~ 21,
SimpleCat== "Sour" ~ 11,
SimpleCat== "Stout" ~ 8,
SimpleCat== "Smoke Flavored" ~ -5,
SimpleCat== "Coffee Flavored" ~ -2,
TRUE ~ 0))
table(filtered_beer$move)
?stremChart
?streamChart
?streamgraph
?scale_fill_gradient2
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "#51A0D1",high = "#3288BD",midpoint = median(df1$LogFold)) + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "#51A0D1",high = "#3288BD") + coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "#51A0D1",high = "#3288BD") + coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD",aesthetics = "fill") + coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+ scale_fill_gradient(low = "#51A0D1",high = "#3288BD",aesthetics = "fill")+geom_bar(stat="identity") + coord_flip()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD",aesthetics = "fill")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
library(ggplot)
library(ggplot2)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(stat="identity") + scale_fill_gradient2(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=SimpleCat, stat="identity") + scale_fill_gradient2(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=SimpleCat), stat="identity") + scale_fill_gradient2(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=SimpleCat), stat="identity") + scale_fill_gradient(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity") + scale_fill_gradient(low = "Blue",high = "Red") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD")+ geom_bar(color="blank") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD")+ geom_bar(aes(device),color="blank") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD")+ geom_bar(aes(move),color="blank") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="black") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3288BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + xlab("Change in Beers Awarded")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab()
?xlab
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD") + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",,color="#3242BD", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#3242BD", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB6B27", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("Change in Beers Awarded") + xlab("")
?lpot)grid
?lpot_grid
?plot_grid
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_y_reverse()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_reverse()
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") scale_y_continuous(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") scale_y_continuous(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_y_continuous(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_continuous(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_y_discrete(position = "right")
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top")
?sg_title
?xlim
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top") + xlim(-20,0)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top") + xlim(0,-20)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top") + ylim(0,-20)
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top") + ylim(-20,0)
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "#F5DF86", colour = NA))
bc1 <- filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#3242BD", show.legend = FALSE) + scale_fill_gradient(low = "#51A0D1",high = "#3288BD") + coord_flip()+ theme_classic() + ylab("INCREASING Awards") + xlab("")
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "#F5DF86", colour = NA))
bc2 <- filtered_beer[filtered_beer$year == 2019 & filtered_beer$move<0,] %>% arrange(desc(move)) %>% ggplot(aes(reorder(SimpleCat, -move, sum),move))+geom_bar(aes(fill=move), stat="identity",color="#FB274D", show.legend = FALSE) + scale_fill_gradient(low = "#FB6B27",high = "#FC8D59") + coord_flip()+ theme_classic() + ylab("DECREASING Awards") + xlab("") + scale_x_discrete(position = "top")+ ylim(-20,0)
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "#F5DF86", colour = NA))
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "#F5DF86", colour = "#F5DF86"))
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "Red", colour = NA))
plot_grid(bc1, bc2, align=v) + theme(plot.background = element_rect(fill = "Red", colour = NA))
plot_grid(bc1, bc2, align="v") + theme(plot.background = element_rect(fill = "Red", colour = NA))
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "Red", colour = "Red"))
plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "cornsilk", colour = "blue"))
cowplot::plot_grid(bc1, bc2) + theme(plot.background = element_rect(fill = "cornsilk", colour = "blue"))
filtered_beer[filtered_beer$year == 2019 & filtered_beer$move>0,]
install.packages("shiny")
library(shiny)
setwd()
setwd("C:/Users/mikew/OneDrive/dev/TidyTuesday/TidyTuesday/CANWindTurbine")
getwd()
runApp('App/WindFarmProject')
